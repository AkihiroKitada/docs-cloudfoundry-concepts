To enable validation of app instance identity:

1. Configure the Gorouter to initiate a TLS handshake to back ends that require it. For instructions, see [TLS to Apps and Other Back End Services](#tls-to-back-end). `router.ca_certs` should include the CA certificate used to sign the certificate configured in `diego.executor.instance_identity_ca_cert`.
- Configure Diego to run a proxy in each container with the following manifest property:
  - `containers.proxy.enabled: true`: This proxy is used to terminate TLS for requests from the Gorouter and present the App Instance certificate in the handshake.<br><br>

Use the [enable-routing-integrity.yml](https://github.com/cloudfoundry/cf-deployment/blob/v1.6.0/operations/experimental/enable-routing-integrity.yml) file from the cf-deployment GitHub repository with your `cf-deployment` manifest to configure the above properties for both the Gorouter and Diego. For more information, see the [cf-deployment](https://github.com/cloudfoundry/cf-deployment) repository on GitHub.
